<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="001-create-table-cds_outbox_Messages" author="Soso Janashvili">
        <sql>
            CREATE TABLE cds_outbox_Messages
            (
                id                   UUID NOT NULL,
                timestamp            TIMESTAMP(7),
                target               VARCHAR(255),
                msg                  TEXT,
                attempts             INTEGER DEFAULT 0,
                "PARTITION"          INTEGER DEFAULT 0,
                lastError            TEXT,
                lastAttemptTimestamp TIMESTAMP(7),
                status               VARCHAR(23),
                PRIMARY KEY (id)
            );
        </sql>
        <rollback>
            <sql>
                DROP TABLE cds_outbox_Messages;
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="002-create-tables-conferences-and-sessions" author="Soso Janashvili">
        <sql>
            CREATE TABLE conferences
            (
                id          UUID DEFAULT gen_random_uuid(),
                name        VARCHAR(100)  NOT NULL,
                location    VARCHAR(100)  NOT NULL,
                description VARCHAR(1000) NOT NULL,
                start_date  DATE,
                end_date    DATE,

                CONSTRAINT pk_conferences PRIMARY KEY (id)
            );

            CREATE TABLE sessions
            (
                id            UUID DEFAULT gen_random_uuid(),
                title         VARCHAR(100) NOT NULL,
                speaker       VARCHAR(100) NOT NULL,
                start_time    TIME,
                end_time      TIME,
                conference_id UUID,

                CONSTRAINT pk_sessions PRIMARY KEY (id),
                CONSTRAINT fk_sessions_conference_id FOREIGN KEY (conference_id) REFERENCES conferences (id)
            );
        </sql>
        <rollback>
            <sql>
                DROP TABLE sessions;
                DROP TABLE conferences;
            </sql>
        </rollback>
    </changeSet>

</databaseChangeLog>
